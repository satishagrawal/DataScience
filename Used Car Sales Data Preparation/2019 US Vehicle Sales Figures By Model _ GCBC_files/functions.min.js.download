/**
 * Copyright: Codetipi
 * Plugin: Let's Live Blog
 * Version: 1.1.0
 */
!function(t){({init:function(){this.cacheDom(),this.cacheData(),this.bindEvents(),this.ajaxCheck("init")},cacheDom:function(){this.$doc=t(document),this.$win=t(window),this.$body=t("body"),this.$entry=t(".lets-live-blog-wrap"),this.$hls=t("#lets-live-blog-highlights"),this.$hlsa=this.$hls.find("a"),this.$entryWrap=this.$entry.find(".lets-live-blog-entry-wrap"),this.$entryHl=this.$entry.find(".lets-live-blog-entry-hl-wrap"),this.$broadcasting=this.$entry.data("status"),this.higlightTitleLdd=!1,this.$entryCount="",this.todoList=""},cacheData:function(){this.$winWidth=this.$win.width()},bindEvents:function(){this.$win.on("resize",this.resize.bind(this)),this.$hlsa.on("click",this.jumphl)},ajaxCheck:function(e){if(2==this.$broadcasting){var i=this;t.ajax({method:"GET",url:letsLiveBlogJs.root_full+"history",data:"pid="+letsLiveBlogJs.data.pid,beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",letsLiveBlogJs.nonce)},success:function(t){"init"===e&&(i.$entryCount=t.length,i.ajaxUpdate()),t.length!==i.$entryCount&&(i.todoList=t.slice(-(t.length-i.$entryCount)),i.theQueue(),i.$entryCount=t.length)},fail:function(t){console.log("ERROR: T : 138")}})}},theQueue:function(){var t=this.todoList.shift();void 0!==t&&("add"===t[0]?this.ajaxAdd({item:t[1],hl:t[3]}):"del"===t[0]?this.ajaxRemove(t[1]):this.ajaxUpdates(t))},ajaxAdd:function(e){var i=this;t.ajax({method:"GET",url:letsLiveBlogJs.root_full+"entry",data:{add:e.item},beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",letsLiveBlogJs.nonce)},success:function(n){if(void 0===e.pos)i.$entryWrap.prepend(n[0].rendered),!1!==e.hl&&(i.checkHlTitle(),i.$entryHl.prepend(n[0].renderedHl));else{i.$entryWrap.children(":eq("+e.pos+")").attr("id",e.item).replaceWith(n[0].rendered);var s=t("#live-feed-hl-"+e.oldItem);!1!==e.hl?(i.checkHlTitle(),s.length>0?s.replaceWith(n[0].renderedHl):i.$entryHl.prepend(n[0].renderedHl)):void 0!==e.oldItem&&s.remove()}i.theQueue()},fail:function(t){console.log("ERROR: T : 138")}})},jumphl:function(e){e.preventDefault();var i=t(this).attr("href");t(i)[0].scrollIntoView({block:"start",behavior:"smooth"})},checkHlTitle:function(){!0!==this.higlightTitleLdd&&(this.$entryHl.prev().hasClass("box-pre-title")||this.$entryHl.before('<div class="box-pre-title">'+letsLiveBlogJs.data.i18n.jumphl+"</div>"),this.higlightTitleLdd=!0)},ajaxUpdates:function(t){this.ajaxAdd({item:t[1],pos:t[2],hl:t[3],oldItem:t[4]})},ajaxRemove:function(e){t("#live-feed-"+e).remove(),t("#live-feed-hl-"+e).remove(),this.theQueue()},ajaxUpdate:function(){var t=this;setInterval(function(){t.ajaxCheck()},letsLiveBlogJs.data.timeInterval)},resize:function(t,e){this.cacheData()}}).init()}(jQuery);